
{% extends 'base.html' %}
{% load static tailwind_tags %}

{% block title %}Hospitals - Streamline Care{% endblock %}

{% block content %}
    <!-- Page Header -->
    <section class="bg-primary/10 py-12">
      <div class="container-custom">
        <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
          Hospitals in Ghana
        </h1>
        <p class="text-lg text-gray-600 max-w-3xl">
          Browse through our directory of leading hospitals in Ghana. Find detailed information about facilities, medical equipment, and available specialists.
        </p>
      </div>
    </section>
      
    <!-- Search and Filter Section -->
    <section class="py-8 border-b">
      <div class="container-custom">
        <div class="flex flex-col md:flex-row gap-4">
          <div class="md:w-2/3 relative">
            <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
            <input
              type="text"
              id="search-input"
              placeholder="Search hospitals by name or description..."
              class="input pl-10"
            >
          </div>
          <div class="md:w-1/3">
            <select
              id="location-filter"
              class="select"
            >
              <option value="">All Locations</option>
            </select>
          </div>
        </div>
      </div>
    </section>

    <!-- Hospitals Listing -->
    <section class="py-12 flex-grow">
      <div class="container-custom">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="hospitals-container">
          {% for hospital in hospitals %}
          <a href="{% url 'hospital_detail' hospital.id %}" class="hospital-card">
            <div class="card-image">
              <img src="{{ hospital.image }}" alt="{{ hospital.name }}">
            </div>
            <div class="card-content">
              <h3 class="card-title">{{ hospital.name }}</h3>
              <div class="card-detail">
                <i class="fas fa-map-marker-alt"></i>
                <span>{{ hospital.location }}</span>
              </div>
              <div class="card-detail">
                <i class="fas fa-phone"></i>
                <span>{{ hospital.phone_number }}</span>
              </div>
              <p class="card-description">{{ hospital.description|truncatewords:20 }}</p>
              <div class="card-footer">
                <span class="card-link">View Details &rarr;</span>
              </div>
            </div>
          </a>
          {% endfor %}
        </div>
        <div id="no-results" class="text-center py-16 hidden">
          <h3 class="text-xl font-semibold text-gray-700 mb-2">No hospitals found</h3>
          <p class="text-gray-500">
            Try adjusting your search or filters to find what you're looking for.
          </p>
        </div>
      </div>
    </section>
{% endblock %}

{% block extra_js %}
<script>
  // Set copyright year
  document.getElementById('current-year').innerText = new Date().getFullYear();
  
  // Get hospitals data from Django context
  const hospitals = {{ hospitals_json|safe }};
  
  const searchInput = document.getElementById('search-input');
  const locationFilter = document.getElementById('location-filter');
  const hospitalsContainer = document.getElementById('hospitals-container');
  const noResults = document.getElementById('no-results');
  
  // Extract unique locations
  const locations = [...new Set(hospitals.map(hospital => hospital.location))];
  
  // Populate location filter
  locations.forEach(location => {
    const option = document.createElement('option');
    option.value = location;
    option.textContent = location;
    locationFilter.appendChild(option);
  });
  
  // Function to filter hospitals
  function filterHospitals() {
    const searchTerm = searchInput.value.toLowerCase();
    const selectedLocation = locationFilter.value;
    
    const filteredHospitals = hospitals.filter(hospital => {
      const matchesSearch = hospital.name.toLowerCase().includes(searchTerm) ||
                           hospital.description.toLowerCase().includes(searchTerm);
      const matchesLocation = selectedLocation ? hospital.location === selectedLocation : true;
      return matchesSearch && matchesLocation;
    });
    
    // Display filtered hospitals or no results message
    if (filteredHospitals.length > 0) {
      hospitalsContainer.innerHTML = filteredHospitals.map(hospital => `
        <a href="/hospital/${hospital.id}/" class="hospital-card">
          <div class="card-image">
            <img src="${hospital.image}" alt="${hospital.name}">
          </div>
          <div class="card-content">
            <h3 class="card-title">${hospital.name}</h3>
            <div class="card-detail">
              <i class="fas fa-map-marker-alt"></i>
              <span>${hospital.location}</span>
            </div>
            <div class="card-detail">
              <i class="fas fa-phone"></i>
              <span>${hospital.phone_number}</span>
            </div>
            <p class="card-description">${hospital.description}</p>
            <div class="card-footer">
              <span class="card-link">View Details &rarr;</span>
            </div>
          </div>
        </a>
      `).join('');
      hospitalsContainer.style.display = 'grid';
      noResults.style.display = 'none';
    } else {
      hospitalsContainer.style.display = 'none';
      noResults.style.display = 'block';
    }
  }
  
  // Initial hospital display
  filterHospitals();
  
  // Event listeners for search and filter
  searchInput.addEventListener('input', filterHospitals);
  locationFilter.addEventListener('change', filterHospitals);
</script>
{% endblock %}
